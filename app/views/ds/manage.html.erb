<h2>Manage <%= @d.name %> Records</h2>
<table>
  <tr>
    <% @d.ds_elements.each do |ds_element|%>
    <th><%= ds_element.name %></th>
    <% end %>
    <th>Position</th>
    <th>Move Up</th>
    <th>Move Down</th>
    <th></th>
    <th></th>
    <th></th>
  </tr>
  <% @records.each do |rec| %>
  <tr>
    <% @d.ds_elements.each do |ds_element|%>
    <td>
      <% if ds_element.ftype == "Text"%>
        <%= truncate(rec.send(ds_element.key)) %>
      <% elsif ds_element.ftype == "Image" %>
        <%= image_tag rec.send(ds_element.key).url(:small) %>
      <% elsif ds_element.ftype == "DateTime" %>
        <%= rec.send(ds_element.key).strftime(@setting.date_format) if rec.send(ds_element.key) %>
      <% else %>
        <%= rec.send(ds_element.key)%>
      <% end %>
    </td>
    <% end %>
    <td><%= rec.position.to_i %></td>
    <td><%= button_to "Up", move_up_record_d_path(@d, :rec_id => rec.id)%></td>
    <td><%= button_to "Down", move_down_record_d_path(@d, :rec_id => rec.id)%></td>
    <td><%= link_to "Show", show_record_d_path(@d, :rec_id => rec.id) %></td>
    <td><%= link_to "Edit", edit_record_d_path(@d, :rec_id => rec.id) %></td>
    <td><%= link_to "Destroy", destroy_record_d_path(@d, :rec_id => rec.id), :confirm => 'Are you sure?', :method => :delete %></td>    
  </tr>
  <% end %>
</table>

<%= link_to "Add Record", new_record_d_path(@d)%> | <%= link_to "Back", ds_path%>
