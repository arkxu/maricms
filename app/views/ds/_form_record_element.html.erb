<% if @d.ds_type == "Tab"%>
  <fieldset>
    <legend>
      Main
    </legend>
    <p>
      <%= form_record_element.label :name %>
      <%= form_record_element.text_field :name %>
    </p>
    <p>
      <%= form_record_element.label :slug %>
      <%= form_record_element.text_field :slug %>      
    </p>
    <p>
      <%= form_record_element.label :page %>
      <%= collection_select :record, "page_id", Page.all, :id, :title, :prompt => true %><%= link_to "Go", edit_page_path(@record.page)%>
    </p>
    <p>
      <%= form_record_element.label :parent %>
      <%= collection_select :record, "parent_id", @d.get_klass.all - [@record], :id, :name, :prompt => true %>
    </p>    
  </fieldset>
<% end %>


<fieldset>
  <legend>Record</legend>
  <% @d.ds_elements.each do |element| %>
    <p>
      <%= form_record_element.label element.name %>
      <% if element.ftype == "File" %>
        <%= form_record_element.file_field element.key %><br/>
        File Name: <%= @record.send("#{element.key}_file_name") %>
      <% elsif element.ftype == "Image" %>
        <%= form_record_element.file_field element.key %><br/>
        <%= image_tag @record.send(element.key).url %>
      <% elsif element.ftype == "Text" %>
        <%= form_record_element.text_area element.key, :id => element.key %>
        <script>
          KE.show({
            id : "<%=element.key%>",
            width : "760px", //编辑器的宽度为70%
            height : "300px", //编辑器的高度为100px
            allowFileManager : true,
            imageUploadJson:'/editor_attachments/upload'
          });
        </script>
      <% elsif element.ftype == "Boolean" %>
        <%= form_record_element.check_box element.key %>
      <% elsif element.ftype == "DateTime" %>
        <%= form_record_element.text_field element.key, :id => element.key %>
        <script>
          $(function() {
            $( "#<%= element.key %>" ).datepicker({ dateFormat: 'yy-mm-dd' });
          });
        </script>
      <% else %>
        <%= form_record_element.text_field element.key %>
      <% end %>
    </p>
  <% end %>

</fieldset>
<!-- <fieldset>
  <legend>Advanced</legend>
  <p>
    <%= form_record_element.label :position %>
    <%= form_record_element.text_field :position %>(Do not change it unless you know what you are doing!)
  </p>
  
</fieldset> -->
